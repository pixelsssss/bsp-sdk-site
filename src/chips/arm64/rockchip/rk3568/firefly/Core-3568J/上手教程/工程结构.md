---
# 这是文章的标题
title: 工程结构
# 这是页面的图标
icon: discover
# 这是侧边栏的顺序
order: 3
# 一个页面可以有多个分类
category:
  - 快速上手
# 一个页面可以有多个标签
tag:
  - 工程结构
---

## 1. 目录结构

```
bsprk3568
│  CHANGELOG
│  config.mk
│  Makefile
│  README.md
│          
└─SylixOS
    │  bspbuild.mk
    │  config.ld
    │  driver-library.mk
    │  libdrv.mk
    │  Makefile
    │  srcs.mk
    │  SylixOSBSP32.ld
    │  SylixOSBSP64.ld
    │  
    ├─bsp
    │  │  board.h
    │  │  bspInit.c
    │  │  bspLib.c
    │  │  bspMap.h
    │  │  libstartup.mk
    │  │  startup.S
    │  │  
    │  ├─aio
    │  │      aio.c
    │  │      aio.h
    │  │      aio.mk
    │  │      README.md
    │  │      
    │  └─evb1
    │         evb1.c
    │         evb1.h
    │         evb1.mk
    │         README.md
    │          
    ├─driver
    │  ├─ahci        
    │  ├─audio          
    │  ├─can
    │  ├─clk  
    │  ├─component
    │  ├─display 
    │  ├─dma 
    │  ├─emmc
    │  ├─gpio
    │  ├─i2c 
    │  ├─include          
    │  ├─irq    
    │  ├─net     
    │  ├─norflash  
    │  ├─nvme  
    │  ├─pci      
    │  ├─phy     
    │  ├─pmic 
    │  ├─psci
    │  ├─pwm 
    │  ├─regulator   
    │  ├─rkflash   
    │  ├─sdmmc 
    │  ├─spi
    │  ├─thermal
    │  ├─timer 
    │  ├─uart
    │  ├─usb      
    │  ├─video         
    │  └─wdt   
    │ 
    ├─lib
    │  ├─arm 
    │  ├─arm64
    │  └─include
    │          
    ├─res 
    │  ├─dts
    │  │  ├─aio
    │  │  ├─dt-bindings       
    │  │  └─evb1
    │  │          
    │  └─tools
    │          
    ├─test
    │      
    └─user
```

## 2. 详细介绍

| 目录/文件                 | 说明                                                         |
| ------------------------- | ------------------------------------------------------------ |
| CHANGELOG                 | bsp 更新记录，包括新功能支持、bug 修复等，同时记录当前 bsp 版本号。 |
| config.mk                 | 最外层配置文件，用于配置 Makefile 功能：① SYLIXOS_BASE_PATH 为 bsp 依赖的 base 工程路径，根据工程属性配置自动生成，无需手动更改；② LINUX_COMPAT_LAYER_PATH 为 bsp 依赖的 Linux 兼容层工程路径，一般自动索引当前工作空间下的兼容层工程，无需手动更改，bsp 工程和兼容层工程需要处于同一工作空间中；③ DEBUG_LEVEL 为当前编译等级，可选 debug 或 release，根据工程属性配置自动生成，无需手动更改；④ FPU_TYPE 为浮点类型配置，根据工程属性配置自动生成，无需手动更改；其他编译配置可手动添加。 |
| Makefile                  | 最外层 Makefile，用于配置需要编译的板级包，导出 config.mk 中定义的配置，同时调用 SylixOS 目录下的 Makefile 执行最终的编译操作。为了节约编译时间，可以在 BOARD_LIST 中只选择需要编译的板级，其他的通过 # 注释。 |
| README.md                 | 用于描述当前 bsp 工程。                                      |
| doc                       | 该目录存放 bsp 平台软件/硬件相关文档，如处理器编程手册、板卡硬件原理图、适配手册等。其中，软件相关文档，如版本信息、配置信息等文档是否需要包含在 bsp 工程中，待确定。 |
| SylixOS/bspbuild.mk       | 被当前目录下的 Makefile 包含，主要定义如下内容：① BSP_BASE_NAME 和 BSP_POST_NAME 表示目标文件名前后缀；② LOCAL_DSYMBOL 表示 bsp 中宏定义配置；③ LOCAL_INC_PATH 表示 bsp 源文件中头文件路径定义；④ LOCAL_DEPEND_LIB 和 LOCAL_DEPEND_LIB_PATH 表示 bsp 依赖的静态库名称及所在路径；⑤ LOCAL_DEPEND_TARGET 表示编译依赖的目标文件，这些目标文件发生改变时，会重新链接生成最终的 bsp 镜像文件，无需 rebuild 整个 bsp 工程；⑥ LOCAL_LD_SCRIPT 表示编译链接脚本文件，根据编译选项选择 32 位或者 64 位。其他暂未用到，不做介绍。 |
| SylixOS/config.ld         | 定义 bsp 的代码段和数据段地址信息、启动栈大小和堆内存结束地址，用于配置链接脚本。 |
| SylixOS/driver-library.mk | 内核静态库类目标 Makefile 模板，从 libsylixos 中的 kernel-library.mk 修改而来，被当前目录下 libdrv.mk 包含，用于将 bsp 中的外设驱动单独预编译生成静态库文件，再次编译时可删除对应外设驱动源文件，适用于不方便提供源码的场景。部分外设驱动静态库编译时需要包含 symbol.h，所以该文件在 kernel-library.mk 基础上新增`$(target)_DSYMBOL   += $(TOOLCHAIN_DEF_SYMBOL)SYLIXOS_EXPORT_KSYMBOL`，用于生成 symbol.h。 |
| SylixOS/libdrv.mk         | 被当前目录下 Makefile 包含，定义了需要编译的外设驱动静态库。 |
| SylixOS/Makefile          | 当前目录的 Makefile 文件，定义了最终生成的 bsp 镜像名，包含了静态库编译 Makefile、源文件编译 Makefile 等，同时还可以选择是否编译设备树。 |
| SylixOS/srcs.mk           | 该文件定义需要编译的源文件。                                 |
| SylixOS/SylixOSBSP32.ld   | 32 位链接脚本文件。                                          |
| SylixOS/SylixOSBSP64.ld   | 64 位链接脚本文件。                                          |
| SylixOS/bsp               | 该目录下包含板级目录和 bspInit.c、bspLib.c、startup.S 等启动文件。其中启动文件由 libstartup.mk 编译生成 libstartup.a，板级目录下包含板级源文件和头文件、板级 Makefile、README.md。 |
| SylixOS/driver            | 该目录下为所有外设驱动目录，每个驱动目录下都有对应的 Makefile 用于生成独立的静态库。 |
| SylixOS/lib               | 该目录为 bsp 依赖的静态库存放目录：① 按架构分为 SylixOS/lib/arm 和 SylixOS/lib/arm64；② bsp 外设驱动静态库存放在 SylixOS/lib/$(ARCH)/libdrv 目录下，其他的外部静态库，如网卡、rtc 等存放在 SylixOS/lib/$(ARCH) 下；③ 外部静态库的头文件统一存放在 SylixOS/lib/include 目录下，如网卡、rtc 等。 |
| SylixOS/res               | 该目录存放设备树、设备树编译工具等资源文件。                 |
| SylixOS/test              | 该目录存放测试程序。                                         |
| SylixOS/user              | 用户目录。                                                   |