---
# 这是文章的标题
title: 板卡启动
# 这是页面的图标
icon: discover
# 这是侧边栏的顺序
order: 4
# 一个页面可以有多个分类
category:
  - 3568J
# 一个页面可以有多个标签
tag:
  - 前言
---

## 1. 启动说明

### 1.1 网络启动

设置 tftp server 路径，参考启动命令如下：

```C
setenv ipaddr 202.197.66.223;setenv serverip 202.197.66.156;tftp 0x9400000 bsprk3568_aio_x64.bin;go 0x9400000
```

其中 ipaddr 是指板卡的 ip 地址，serverip 是指主机的 ip 地址，根据实际情况修改设置。

启动过程如下：

```C
=> setenv ipaddr 202.197.66.223;setenv serverip 202.197.66.156;tftp 0x9400000 bsprk3568_aio_x64.bin;go 0x9400000
ethernet@fe010000 Waiting for PHY auto negotiation to complete. done
Using ethernet@fe010000 device
TFTP from server 202.197.66.156; our IP address is 202.197.66.223
Filename 'bsprk3568_aio_x64.bin'.
Load address: 0x9400000
Loading: #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         #################################################################
         ###################################################
         589.8 KiB/s
done
Bytes transferred = 4586432 (45fbc0 hex)
## Starting application at 0x09400000 ...
Linux compatibility layer version: 1.0.9-beta.
Linux compatibility layer top half init finished.
Block device /dev/blk/sdcard-0 part 0 mount to /media/sdcard0 use vfat file system.
Block device /dev/blk/sdcard-0 part 1 mount to /media/sdcard1 use vfat file system.
Block device /dev/blk/sdcard-0 part 2 mount to /media/sdcard2 use vfat file system.
Block device /dev/blk/sdcard-0 part 3 mount to /media/sdcard3 use vfat file system.
Block device /dev/blk/sdcard-0 part 4 mount to /media/sdcard4 use vfat file system.
Block device /dev/blk/sdcard-0 part 5 mount to /media/sdcard5 use vfat file system.
Block device /dev/blk/sdcard-0 part 6 mount to /media/sdcard6 use vfat file system.
Block device /dev/blk/sdcard-0 part 7 mount to /media/sdcard7 use vfat file system.
Block device /dev/blk/sdcard-0 part 8 mount to /media/sdcard8 use vfat file system.
Block device /dev/blk/sdcard-0 part 9 mount to /media/sdcard9 use vfat file system.
Block device /dev/blk/sdcard-0 part 10 mount to /media/sdcard10 use tpsfs file system.
Block device /dev/blk/nvme-0 part 0 mount to /media/nvme0 use vfat file system.
Block device /dev/blk/nvme-0 part 1 mount to /media/nvme1 use tpsfs file system.
rockchip_clk_register_branches: unknown clock type 11

mount sd memory card successfully.
environment variables load from /etc/profile fail, error: No such file or directory
[ifparam]No network parameter for [dw_1] from /etc/ifparam.ini, default parameters will be used.
I/TC: Secondary CPU 1 initializing
I/TC: Secondary CPU 1 switching to normal world boot
I/TC: Secondary CPU 2 initializing
I/TC: Secondary CPU 2 switching to normal world boot
I/TC: Secondary CPU 3 initializing
I/TC: Secondary CPU 3 switching to normal world boot
: Failed to reset the dma
stmmac_hw_setup: DMA engine initialization failed
stmmac_init: Hw setup failed
dwProbe: netdev_add error!
Linux compatibility layer bottom half init finished.
cpu current freq 1800000000 Hz, voltage 1125000 uV.
Press <n> to NOT execute /etc/startup.sh (timeout: 1 sec(s))
default shell stack: 1200000
sysname  : sylixos
nodename : sylixos
release  : Enterprise
version  : 2.3.8
machine  : RK3568(ARMv8-A, 4 Core, Up to 2.0GHz, Current 1.8GHz)


                          [[                          (R)
 [[[[           [[[[      [[             [[[[    [[[[ 
[[  [[            [[                    [[  [[  [[  [[
[[      [[  [[    [[    [[[[    [[  [[  [[  [[  [[    
 [[     [[  [[    [[      [[    [[  [[  [[  [[   [[   
  [[    [[  [[    [[      [[     [[[[   [[  [[    [[  
   [[   [[  [[    [[      [[      [[    [[  [[     [[ 
    [[  [[  [[    [[      [[     [[[[   [[  [[      [[
[[  [[  [[  [[    [[      [[    [[  [[  [[  [[  [[  [[
 [[[[    [[[[   [[[[[[  [[[[[[  [[  [[   [[[[    [[[[ 
           [[                                         
          [[    KERNEL: LongWing(C) 2.3.8
       [[[[   COPYRIGHT ACOINFO Co. Ltd. 2006 - 2022

SylixOS license: Commercial & GPL.
SylixOS kernel version: 2.3.8 Code name: Enterprise

CPU     : RK3568(ARMv8-A, 4 Core, Up to 2.0GHz, Current 1.8GHz)
CACHE   : 64KBytes L1-Cache(D-32K/I-32K), 0 Bytes L2-Cache, 512KBytes L3-Cache
PACKET  : AIO-3568J Packet
ROM SIZE: 0x00100000 Bytes (0x00000000 - 0x000fffff)
RAM SIZE: 0x72c00000 Bytes (0x09400000 - 0x7bffffff)
BSP     : BSP Version 2.1.0 (Release) for Enterprise (Build Nov 16 2022 17:29:50)
[root@sylixos:/root]# dw: en2 NIC Link is Up 1000 Mbps Full Duplex
```

### 1.2 eMMC 启动

rk3568 板卡一般出厂固件都是按照 GPT 分区表格式烧录到硬件板卡的 eMMC 中，且 uboot 下只能识别 eMMC 的 GPT 分区表，所以需要使用最新内核已支持的 GPT 分区方法。

另外，需要注意的是，由于 uboot 跟 linux 共用的设备树，所以需要保留相关分区，否则会导致 uboot 功能异常，而不同板卡不同固件可能需要保留的分区均有差异，所以对不同板卡的 eMMC 要根据实际情况调整分区操作。

Firefly 3568J 板卡出厂自带的固件 uboot 无法保存环境变量，所以需要对 uboot 的配置进行修改，并重新编译烧写，此处仅介绍修改过程，编译和烧写方法参考官网。

#### 1.2.1 **查看原厂固件 eMMC 分区**

```C
=> mmc part

Partition Map for MMC device 0  --   Partition Type: EFI

Part    Start LBA       End LBA         Name
        Attributes
        Type GUID
        Partition GUID
  1     0x00002000      0x00003fff      "security"
        attrs:  0x0000000000000000
        type:   0b150000-0000-4740-8000-55d700001302
        guid:   9b310000-0000-4675-8000-21f700007add
  2     0x00004000      0x00005fff      "uboot"
        attrs:  0x0000000000000000
        type:   c05c0000-0000-4706-8000-217d000024f4
        guid:   ea1a0000-0000-4c6f-8000-4878000007a7
  3     0x00006000      0x00007fff      "trust"
        attrs:  0x0000000000000000
        type:   cb030000-0000-4518-8000-083b00006d98
        guid:   54160000-0000-451e-8000-1f5600003ea7
  4     0x00008000      0x00009fff      "misc"
        attrs:  0x0000000000000000
        type:   b5030000-0000-4b29-8000-6499000053f5
        guid:   60000000-0000-4a37-8000-1f17000046e4
  5     0x0000a000      0x0000bfff      "dtbo"
        attrs:  0x0000000000000000
        type:   05160000-0000-4171-8000-512000003f13
        guid:   96740000-0000-4275-8000-084500004966
  6     0x0000c000      0x0000c7ff      "vbmeta"
        attrs:  0x0000000000000000
        type:   433c0000-0000-4d2b-8000-2f5700001dfb
        guid:   7e540000-0000-4514-8000-5c6700007635
  7     0x0000c800      0x0003c7ff      "boot"
        attrs:  0x0000000000000000
        type:   f8370000-0000-4918-8000-22c700005db4
        guid:   a1440000-0000-4b57-8000-600600007f5a
  8     0x0003c800      0x0006c7ff      "recovery"
        attrs:  0x0000000000000000
        type:   ab0f0000-0000-4d7b-8000-12f600007646
        guid:   862e0000-0000-4d04-8000-1fa900001cdc
  9     0x0006c800      0x0012c7ff      "backup"
        attrs:  0x0000000000000000
        type:   e40e0000-0000-4f1b-8000-2b6e00005eba
        guid:   b53f0000-0000-4363-8000-66d8000007c3
 10     0x0012c800      0x001ec7ff      "cache"
        attrs:  0x0000000000000000
        type:   2b450000-0000-4945-8000-5db700001317
        guid:   b7690000-0000-4343-8000-491c00007e17
 11     0x001ec800      0x001f47ff      "metadata"
        attrs:  0x0000000000000000
        type:   09060000-0000-4248-8000-5e5700001565
        guid:   135f0000-0000-4775-8000-1dfb000045e1
 12     0x001f4800      0x008087ff      "super"
        attrs:  0x0000000000000000
        type:   05690000-0000-4377-8000-24d800006aad
        guid:   511c0000-0000-464f-8000-7cff00002129
 13     0x00808800      0x009087ff      "oem"
        attrs:  0x0000000000000000
        type:   a8480000-0000-422a-8000-6cc2000019f6
        guid:   fa5d0000-0000-482b-8000-45b000005ef5
 14     0x00908800      0x03a3dfbf      "userdata"
        attrs:  0x0000000000000000
        type:   78420000-0000-493d-8000-369b00003048
        guid:   95220000-0000-4665-8000-1a9500004b4f
```

通过查看固件编译环境生成物 parameter.txt （位于编译环境根目录 “rockdev\Image-rk3568_firefly_aioj”），推测 eMMC 分区信息是由某个脚本生成。

#### 1.2.2 **查找编译脚本**

sdk 编译过程中关于 parameter.txt 的 log 信息，如下：

```C
build parameter.txt with device/rockchip/common/scripts/parameter_tools/parameter.in....
```

查看 parameter.in 文件，该文件中有如下字段

```C
CMDLINE:mtdparts=rk29xxnand:${_partition_list}
```

在整个 sdk 中全局搜索 “partition_list” 字段，发现位于 “./device/rockchip/common/build/rockchip/RebuildParameter.mk” 中，在该文件中定义了 eMMC 分区的所有信息。

#### 1.2.3 **新增环境变量分区**

尝试在原分区的 backup 分区之前添加一段空间用于保存 uboot 的环境变量，参考操作如下：

```C
partition_list := $(partition_list),backup:384M,cache:$(BOARD_CACHEIMAGE_PARTITION_SIZE),metadata:16M
```

修改为

```C
partition_list := $(partition_list),uboot_env:1M
partition_list := $(partition_list),backup:384M,cache:$(BOARD_CACHEIMAGE_PARTITION_SIZE),metadata:16M
```

通过原 backup 分区的 Start LBA 可以计算得出，新增的 uboot_env 分区的 Start LBA 为 0x0006c800，占用扇区数量为 0x800。

#### 1.2.4 **配置 uboot**

参考 [U-Boot 使用](https://wiki.t-firefly.com/Core-3568J/uboot_introduction.html)，在 sdk 的 u-boot 目录下执行 make menuconfig，进入配置界面。

在 **Environment ->Select the location of the environment** 中选择 **Environment in an MMC device**，同时 **Environment offset** 设置为 0xd900000（起始扇区为 0x0006c800，每个扇区 512 Byte，计算起始地址为 0xd900000）， **Environment size** 设置为 0x100000。

保存退出后，执行 “**make ARCH=arm64 savedefconfig**” 保存配置，并执行 “**cp defconfig configs/rk3568_defconfig**” 替换配置文件（原配置文件可先备份以防配置出错）。

#### 1.2.5 **重新编译** **sdk**

重新编译 sdk，生成的 parameter.txt 中的信息如下，可以看到新增了一个 “uboot_env” 分区。

```C
FIRMWARE_VER: 11.0
MACHINE_MODEL: AIO-3568J
MACHINE_ID: 007
MANUFACTURER: T-CHIP
MAGIC: 0x5041524B
ATAG: 0x00200800
MACHINE: rk3568_firefly_aioj
CHECK_MASK: 0x80
PWR_HLD: 0,0,A,0,1
TYPE: GPT
CMDLINE:mtdparts=rk29xxnand:0x00002000@0x00002000(security),0x00002000@0x00004000(uboot),0x00002000@0x00006000(trust),0x00002000@0x00008000(misc),0x00002000@0x0000a000(dtbo),0x00000800@0x0000c000(vbmeta),0x00030000@0x0000c800(boot),0x00030000@0x0003c800(recovery),0x00000800@0x0006c800(uboot_env),0x000c0000@0x0006d000(backup),0x000c0000@0x0012d000(cache),0x00008000@0x001ed000(metadata),0x00000800@0x001f5000(baseparameter),0x00614000@0x001f5800(super),0x00100000@0x00809800(oem),-@0x00909800(userdata:grow)
```

#### 1.2.6 **烧录固件**

编译生成的固件位于 sdk 的 “rockdev\Image-rk3568_firefly_aioj” 目录下，名为 AIO-3568J_Android11_HDMI_日期XXX.img，重新烧录固件，参照 [更新固件介绍](https://wiki.t-firefly.com/Core-3568J/01-bootmode.html)。

在 uboot 下查看 eMMC 分区信息如下：

```C
=> mmc part

Partition Map for MMC device 0  --   Partition Type: EFI

Part    Start LBA       End LBA         Name
        Attributes
        Type GUID
        Partition GUID
  1     0x00002000      0x00003fff      "security"
        attrs:  0x0000000000000000
        type:   87710000-0000-403b-8000-3b0900005ae7
        guid:   ba450000-0000-4245-8000-4b6100005aa3
  2     0x00004000      0x00005fff      "uboot"
        attrs:  0x0000000000000000
        type:   fb5b0000-0000-4f6c-8000-423700003982
        guid:   fb0d0000-0000-4a76-8000-14dd00006128
  3     0x00006000      0x00007fff      "trust"
        attrs:  0x0000000000000000
        type:   aa1b0000-0000-4266-8000-00e200005c73
        guid:   39790000-0000-4943-8000-611800002586
  4     0x00008000      0x00009fff      "misc"
        attrs:  0x0000000000000000
        type:   1b1c0000-0000-4070-8000-7f91000077c1
        guid:   ff520000-0000-4874-8000-5d9c00001fc5
  5     0x0000a000      0x0000bfff      "dtbo"
        attrs:  0x0000000000000000
        type:   d60a0000-0000-4152-8000-0dcc00004774
        guid:   d2280000-0000-4d54-8000-79f100004bee
  6     0x0000c000      0x0000c7ff      "vbmeta"
        attrs:  0x0000000000000000
        type:   64560000-0000-4e5b-8000-3b1c00000995
        guid:   3c4f0000-0000-4333-8000-689d00002b09
  7     0x0000c800      0x0003c7ff      "boot"
        attrs:  0x0000000000000000
        type:   4c350000-0000-4d5d-8000-61070000002b
        guid:   c45d0000-0000-4f64-8000-242a0000441c
  8     0x0003c800      0x0006c7ff      "recovery"
        attrs:  0x0000000000000000
        type:   16200000-0000-492c-8000-19170000733e
        guid:   f32d0000-0000-4b40-8000-672000001d31
  9     0x0006c800      0x0006cfff      "uboot_env"
        attrs:  0x0000000000000000
        type:   4b550000-0000-4723-8000-3fd400002dd7
        guid:   4f5f0000-0000-4e21-8000-32050000434f
 10     0x0006d000      0x0012cfff      "backup"
        attrs:  0x0000000000000000
        type:   72550000-0000-411f-8000-78c500007cfc
        guid:   62560000-0000-4068-8000-49630000487f
 11     0x0012d000      0x001ecfff      "cache"
        attrs:  0x0000000000000000
        type:   13650000-0000-4e02-8000-2872000033b8
        guid:   b4390000-0000-4a78-8000-35c100003fc8
 12     0x001ed000      0x001f4fff      "metadata"
        attrs:  0x0000000000000000
        type:   b60e0000-0000-4631-8000-7b6300002910
        guid:   cb730000-0000-4339-8000-41a800004132
 13     0x001f5000      0x001f57ff      "baseparameter"
        attrs:  0x0000000000000000
        type:   e41d0000-0000-4216-8000-5d210000380e
        guid:   31340000-0000-4317-8000-7e9f00006cc5
 14     0x001f5800      0x008097ff      "super"
        attrs:  0x0000000000000000
        type:   24240000-0000-4920-8000-023300003eb9
        guid:   6e6e0000-0000-4300-8000-402e00005f8a
 15     0x00809800      0x009097ff      "oem"
        attrs:  0x0000000000000000
        type:   ff770000-0000-433e-8000-5f2100001f19
        guid:   08580000-0000-4a69-8000-20dd00004088
 16     0x00909800      0x03a49fde      "userdata"
        attrs:  0x0000000000000000
        type:   fc300000-0000-4968-8000-2f7400004237
        guid:   896f0000-0000-404a-8000-7835000036c7
```

可以看到新增了环境变量保存分区，同时 **saveenv** 命令也能成功执行。

#### 1.2.7 **eMMC 分区**

通过网络启动 SylixOS 后，对 eMMC 进行分区操作。需要注意的是，由于 uboot 跟 linux 共用的设备树，所以需要保留相关分区，否则会导致 uboot 功能异常。

针对 Firefly 3568J 板卡，eMMC 保留前 9 个分区，并外加两个系统分区，共计需要分 11 个分区，具体操作如下：

```C
[unknown@sylixos:/]# fdisk -fgpt /dev/blk/sdcard-0
block device /dev/blk/sdcard-0 total size: 29844 (MB)
please input how many partition(s) you want to make (1 ~ 16) : 11
please input how many bytes align (4K 8K ...) : 4096
please input gpt partition first lba (34 ~ 18446744073709551615) offset. 0 means use default offset: 8192
please input the partition 0 size percentage(%) or capacity(M) 0 means all left space : 4M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): security
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 1 size percentage(%) or capacity(M) 0 means all left space : 4M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): uboot
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 2 size percentage(%) or capacity(M) 0 means all left space : 4M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): trust
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 3 size percentage(%) or capacity(M) 0 means all left space : 4M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): misc
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 4 size percentage(%) or capacity(M) 0 means all left space : 4M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): dtbo
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 5 size percentage(%) or capacity(M) 0 means all left space : 1M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): vbmeta
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 6 size percentage(%) or capacity(M) 0 means all left space : 96M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): boot
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 7 size percentage(%) or capacity(M) 0 means all left space : 96M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): recovery
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 8 size percentage(%) or capacity(M) 0 means all left space : 1M
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): uboot_env
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
5
please input the partition 9 size percentage(%) or capacity(M) 0 means all left space : 10
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): fatfs
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
1
please input the partition 10 size percentage(%) or capacity(M) 0 means all left space : 0
please input the partition name (default is "SylixOSPartn", which n is stand for partition number): tpsfs
please input the file system type
1: FAT   2: TPSFS   3: LINUX   4: RESERVED  5:EFI
2
making partition...
block device  : /dev/blk/sdcard-0
block type    : SD/MMC
block serial  : 01FEFC2B
block firmware: 2021.03, v-8.10
block product : X2932 MMC/eMMC memory card
block media   : MMC/eMMC(v5.1), 512(R) 512(W)

GPT partition >>

PART ACT  SIZE(KB)  OFFSET(KB)             TYPE
---- --- ---------- ---------- -------------------------------------
   0  *        4096       4096 EFI Partition
   1  *        4096       8192 EFI Partition
   2  *        4096      12288 EFI Partition
   3  *        4096      16384 EFI Partition
   4  *        4096      20480 EFI Partition
   5  *        1024      24576 EFI Partition
   6  *       98304      25600 EFI Partition
   7  *       98304     123904 EFI Partition
   8  *        1024     222208 EFI Partition
   9        3056024     223232 Win95 FAT32 Partition
  10       27280980    3279256 SylixOS True Power Safe Partition

total partition 11
[unknown@sylixos:/]# remount /dev/blk/sdcard-0
Block device /dev/blk/sdcard-0 part 0 mount to /media/sdcard0 use vfat file system.
Block device /dev/blk/sdcard-0 part 1 mount to /media/sdcard1 use vfat file system.
Block device /dev/blk/sdcard-0 part 2 mount to /media/sdcard2 use vfat file system.
Block device /dev/blk/sdcard-0 part 3 mount to /media/sdcard3 use vfat file system.
Block device /dev/blk/sdcard-0 part 4 mount to /media/sdcard4 use vfat file system.
Block device /dev/blk/sdcard-0 part 5 mount to /media/sdcard5 use vfat file system.
Block device /dev/blk/sdcard-0 part 6 mount to /media/sdcard6 use vfat file system.
Block device /dev/blk/sdcard-0 part 7 mount to /media/sdcard7 use vfat file system.
Block device /dev/blk/sdcard-0 part 8 mount to /media/sdcard8 use vfat file system.
Block device /dev/blk/sdcard-0 part 9 mount to /media/sdcard9 use vfat file system.
Magic number error, mount failed
Block device /dev/blk/sdcard-0 part 10 mount to /media/sdcard10 use tpsfs file system.
[unknown@sylixos:/]# mkfs /media/sdcard9
now format media, please wait...
disk format ok.
[unknown@sylixos:/]# mkfs /media/sdcard10
now format media, please wait...
disk format ok.
```

注：

① **please input gpt partition first lba**：内核默认的起始扇区是 34，所以需要根据分区信息调整起始扇区，0x00002000 换算为十进制即为 8192。

③ 各分区大小计算方法，以 "security" 为例，Start LBA ~ End LBA 共 0x00002000 个扇区，每个扇区大小为 512 字节，8192 * 512 字节 =  4096KByte = 4MByte，其余分区类似，且**需要严格设置保留分区名**。

④ **保留的分区类型选择 EFI，且不要有任何操作，以防破坏 uboot 环境**。

⑤ 根据实际分区信息设置板级头文件中启动参数的文件系统挂载路径，如 "rfsmap=/boot:/media/sdcard9,/:/media/sdcard10"。

⑥ 分区完成后，挂载设备，对最后两个分区进行格式化，并通过  ftp 工具将 bsprk3568_aio_x64.bin 上传到 fatfs 分区目录下，执行 sync 操作后，重启板卡进入 uboot 命令行。

#### 1.2.8 **查看分区操作后的信息**

uboot 下查看分区操作后的信息如下：

```C
=> mmc part

Partition Map for MMC device 0  --   Partition Type: EFI

Part    Start LBA       End LBA         Name
        Attributes
        Type GUID
        Partition GUID
  1     0x00002000      0x00003fff      "security"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-60b7acd93ab5
  2     0x00004000      0x00005fff      "uboot"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-4431b7821c06
  3     0x00006000      0x00007fff      "trust"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-06058ed856e5
  4     0x00008000      0x00009fff      "misc"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-56f32f4377a4
  5     0x0000a000      0x0000bfff      "dtbo"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-31169898427c
  6     0x0000c000      0x0000c7ff      "vbmeta"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-6a5d128c046c
  7     0x0000c800      0x0003c7ff      "boot"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-06d7d4b343cd
  8     0x0003c800      0x0006c7ff      "recovery"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-55e8391700fc
  9     0x0006c800      0x0006cfff      "uboot_env"
        attrs:  0x0000000000000000
        type:   c12a7328-f81f-11d2-ba4b-00a0c93ec93b
        guid:   62d2267e-0000-1000-d761-3113c398088e
 10     0x0006d000      0x0064132f      "fatfs"
        attrs:  0x0000000000000000
        type:   ebd0a0a2-b9e5-4433-87c0-68b6b72699c7
        guid:   62d2267e-0000-1000-d761-35702e2f57e8
 11     0x00641330      0x03a49fd7      "tpsfs"
        attrs:  0x0000000000000000
        type:   ebd0a0a2-b9e5-4433-87c0-68b6b72699c7
        guid:   62d2267e-0000-1000-d761-4b63962d7718
```

可以看到保留的 9 个分区和两个 SylixOS 系统分区，通过以下操作查看 fatfs 分区下文件：

```C
=> mmc dev 0;fatls mmc 0:a 
switch to partitions #0, OK
mmc0(part 0) is current device
  4586416   bsprk3568_aio_x64.bin

1 file(s), 0 dir(s)
```

#### 1.2.9 **启动 SylixOS**

由于 uboot 已经支持环境变量保存功能，所以可以直接设置从 eMMC 加载的启动命令。

```C
=> setenv bootcmd "mmc dev 0; fatload mmc 0:a 0x9400000 bsprk3568_aio_x64.bin; go 0x9400000"
=> saveenv 
Saving Environment to MMC...
Writing to MMC(0)... done
=> boot
switch to partitions #0, OK
mmc0(part 0) is current device
reading bsprk3568_aio_x64.bin
4586416 bytes read in 26 ms (168.2 MiB/s)
## Starting application at 0x09400000 ...
Linux compatibility layer version: 1.0.9-beta.
Linux compatibility layer top half init finished.
Block device /dev/blk/sdcard-0 part 0 mount to /media/sdcard0 use vfat file system.
Block device /dev/blk/sdcard-0 part 1 mount to /media/sdcard1 use vfat file system.
Block device /dev/blk/sdcard-0 part 2 mount to /media/sdcard2 use vfat file system.
Block device /dev/blk/sdcard-0 part 3 mount to /media/sdcard3 use vfat file system.
Block device /dev/blk/sdcard-0 part 4 mount to /media/sdcard4 use vfat file system.
Block device /dev/blk/sdcard-0 part 5 mount to /media/sdcard5 use vfat file system.
Block device /dev/blk/sdcard-0 part 6 mount to /media/sdcard6 use vfat file system.
Block device /dev/blk/sdcard-0 part 7 mount to /media/sdcard7 use vfat file system.
Block device /dev/blk/sdcard-0 part 8 mount to /media/sdcard8 use vfat file system.
Block device /dev/blk/sdcard-0 part 9 mount to /media/sdcard9 use vfat file system.
Block device /dev/blk/sdcard-0 part 10 mount to /media/sdcard10 use tpsfs file system.
Block device /dev/blk/nvme-0 part 0 mount to /media/nvme0 use vfat file system.
Block device /dev/blk/nvme-0 part 1 mount to /media/nvme1 use tpsfs file system.
rockchip_clk_register_branches: unknown clock type 11

mount sd memory card successfully.
environment variables load from /etc/profile fail, error: No such file or directory
[ifparam]No network parameter for [dw_1] from /etc/ifparam.ini, default parameters will be used.
I/TC: Secondary CPU 1 initializing
I/TC: Secondary CPU 1 switching to normal world boot
I/TC: Secondary CPU 2 initializing
I/TC: Secondary CPU 2 switching to normal world boot
I/TC: Secondary CPU 3 initializing
I/TC: Secondary CPU 3 switching to normal world boot
: Failed to reset the dma
stmmac_hw_setup: DMA engine initialization failed
stmmac_init: Hw setup failed
dwProbe: netdev_add error!
Linux compatibility layer bottom half init finished.
cpu current freq 1800000000 Hz, voltage 1125000 uV.
Press <n> to NOT execute /etc/startup.sh (timeout: 1 sec(s))
default shell stack: 1200000
sysname  : sylixos
nodename : sylixos
release  : Enterprise
version  : 2.3.8
machine  : RK3568(ARMv8-A, 4 Core, Up to 2.0GHz, Current 1.8GHz)


                          [[                          (R)
 [[[[           [[[[      [[             [[[[    [[[[ 
[[  [[            [[                    [[  [[  [[  [[
[[      [[  [[    [[    [[[[    [[  [[  [[  [[  [[    
 [[     [[  [[    [[      [[    [[  [[  [[  [[   [[   
  [[    [[  [[    [[      [[     [[[[   [[  [[    [[  
   [[   [[  [[    [[      [[      [[    [[  [[     [[ 
    [[  [[  [[    [[      [[     [[[[   [[  [[      [[
[[  [[  [[  [[    [[      [[    [[  [[  [[  [[  [[  [[
 [[[[    [[[[   [[[[[[  [[[[[[  [[  [[   [[[[    [[[[ 
           [[                                         
          [[    KERNEL: LongWing(C) 2.3.8
       [[[[   COPYRIGHT ACOINFO Co. Ltd. 2006 - 2022

SylixOS license: Commercial & GPL.
SylixOS kernel version: 2.3.8 Code name: Enterprise

CPU     : RK3568(ARMv8-A, 4 Core, Up to 2.0GHz, Current 1.8GHz)
CACHE   : 64KBytes L1-Cache(D-32K/I-32K), 0 Bytes L2-Cache, 512KBytes L3-Cache
PACKET  : AIO-3568J Packet
ROM SIZE: 0x00100000 Bytes (0x00000000 - 0x000fffff)
RAM SIZE: 0x72c00000 Bytes (0x09400000 - 0x7bffffff)
BSP     : BSP Version 2.1.0 (Release) for Enterprise (Build Nov 16 2022 17:29:50)
[root@sylixos:/root]# dw: en2 NIC Link is Up 1000 Mbps Full Duplex
```